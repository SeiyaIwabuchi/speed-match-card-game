openapi: "3.1.0"
info:
  title: "Speed Match API"
  description: "ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒãƒƒãƒ - ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¯¾æˆ¦å‹ã‚«ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ API"
  version: "0.0.1"
servers:
  - url: "http://127.0.0.1:8080"
    description: "Development server"

components:
  schemas:
    # å…±é€šãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¹ã‚­ãƒ¼ãƒ
    ApiResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          description: "ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿"
        message:
          type: string
          description: "æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"

    ApiErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          $ref: "#/components/schemas/ErrorDetails"

    ErrorDetails:
      type: object
      properties:
        code:
          type: string
          description: "ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰"
          example: "VALIDATION_ERROR"
        message:
          type: string
          description: "ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
          example: "ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"
        details:
          type: object
          description: "è¿½åŠ ã®ã‚¨ãƒ©ãƒ¼è©³ç´°"

    # ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼é–¢é€£ã‚¹ã‚­ãƒ¼ãƒ
    PlayerCreateRequest:
      type: object
      required:
        - username
        - avatar
      properties:
        username:
          type: string
          minLength: 3
          maxLength: 12
          pattern: "^[a-zA-Z0-9_]+$"
          description: "ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼ˆ3-12æ–‡å­—ã€è‹±æ•°å­—ã¨ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã®ã¿ï¼‰"
          example: "player123"
        avatar:
          type: string
          minLength: 1
          maxLength: 1
          description: "ã‚¢ãƒã‚¿ãƒ¼ï¼ˆçµµæ–‡å­—ã¾ãŸã¯è‹±å­—1æ–‡å­—ï¼‰"
          example: "ğŸ‘¤"

    PlayerUpdateRequest:
      type: object
      properties:
        username:
          type: string
          minLength: 3
          maxLength: 12
          pattern: "^[a-zA-Z0-9_]+$"
          description: "ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼ˆ3-12æ–‡å­—ã€è‹±æ•°å­—ã¨ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã®ã¿ï¼‰"
          example: "newname"
        avatar:
          type: string
          minLength: 1
          maxLength: 1
          description: "ã‚¢ãƒã‚¿ãƒ¼ï¼ˆçµµæ–‡å­—ã¾ãŸã¯è‹±å­—1æ–‡å­—ï¼‰"
          example: "ğŸ®"

    PlayerResponse:
      type: object
      properties:
        playerId:
          type: string
          description: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ID"
          example: "pl_1234567890"
        username:
          type: string
          description: "ãƒ¦ãƒ¼ã‚¶ãƒ¼å"
          example: "player123"
        avatar:
          type: string
          description: "ã‚¢ãƒã‚¿ãƒ¼"
          example: "ğŸ‘¤"
        stats:
          $ref: "#/components/schemas/PlayerStats"
        createdAt:
          type: string
          format: date-time
          description: "ä½œæˆæ—¥æ™‚"
          example: "2025-10-11T10:00:00Z"

    PlayerStats:
      type: object
      properties:
        totalGames:
          type: integer
          description: "ç·ãƒ—ãƒ¬ã‚¤å›æ•°"
          example: 50
        wins:
          type: integer
          description: "å‹åˆ©æ•°"
          example: 25
        losses:
          type: integer
          description: "æ•—åŒ—æ•°"
          example: 25
        winRate:
          type: number
          format: float
          description: "å‹ç‡"
          example: 0.5
        fastestWin:
          type: integer
          nullable: true
          description: "æœ€é€Ÿå‹åˆ©ã‚¿ãƒ¼ãƒ³æ•°"
          example: 8
        totalCardsPlayed:
          type: integer
          description: "ç·ã‚«ãƒ¼ãƒ‰ãƒ—ãƒ¬ã‚¤æ•°"
          example: 400

    PlayerStatsResponse:
      type: object
      properties:
        playerId:
          type: string
          description: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ID"
          example: "pl_1234567890"
        stats:
          $ref: "#/components/schemas/PlayerStats"

paths:
  /:
    get:
      summary: "Hello World"
      description: "ã‚·ãƒ³ãƒ—ãƒ«ãªHello Worldã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ"
      responses:
        "200":
          description: "æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹"
          content:
            text/plain:
              schema:
                type: "string"
                example: "Hello World!"

  /health:
    get:
      summary: "Health Check"
      description: "ã‚µãƒ¼ãƒãƒ¼ã®ç¨¼åƒçŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ"
      responses:
        "200":
          description: "ã‚µãƒ¼ãƒãƒ¼ãŒæ­£å¸¸ã«ç¨¼åƒä¸­"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  status:
                    type: "string"
                    example: "OK"
                  timestamp:
                    type: "string"
                    format: "date-time"
                    example: "2025-10-16T14:59:55.459Z"

  /api/v1/hello:
    get:
      summary: "API v1 Hello"
      description: "API v1ã®Helloã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ"
      responses:
        "200":
          description: "æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹"
          content:
            text/plain:
              schema:
                type: "string"
                example: "Hello from API v1!"

  # ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†API
  /api/players:
    post:
      summary: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç™»éŒ²"
      description: "æ–°è¦ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ç™»éŒ²ã—ã¾ã™"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PlayerCreateRequest"
      responses:
        "201":
          description: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã¾ã—ãŸ"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/PlayerResponse"
        "400":
          description: "ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiErrorResponse"
        "409":
          description: "ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒæ—¢ã«å­˜åœ¨ã—ã¾ã™"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiErrorResponse"

  /api/players/{playerId}:
    parameters:
      - name: playerId
        in: path
        required: true
        schema:
          type: string
        description: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ID"
        example: "pl_1234567890"

    get:
      summary: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æƒ…å ±å–å¾—"
      description: "æŒ‡å®šã•ã‚ŒãŸãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æƒ…å ±ã‚’å–å¾—ã—ã¾ã™"
      responses:
        "200":
          description: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æƒ…å ±"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/PlayerResponse"
        "404":
          description: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiErrorResponse"

    put:
      summary: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æƒ…å ±æ›´æ–°"
      description: "æŒ‡å®šã•ã‚ŒãŸãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã™"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PlayerUpdateRequest"
      responses:
        "200":
          description: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æƒ…å ±ãŒæ­£å¸¸ã«æ›´æ–°ã•ã‚Œã¾ã—ãŸ"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/PlayerResponse"
        "400":
          description: "ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiErrorResponse"
        "404":
          description: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiErrorResponse"
        "409":
          description: "ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒæ—¢ã«å­˜åœ¨ã—ã¾ã™"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiErrorResponse"

  /api/players/{playerId}/stats:
    parameters:
      - name: playerId
        in: path
        required: true
        schema:
          type: string
        description: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ID"
        example: "pl_1234567890"

    get:
      summary: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼çµ±è¨ˆå–å¾—"
      description: "æŒ‡å®šã•ã‚ŒãŸãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è©³ç´°çµ±è¨ˆã‚’å–å¾—ã—ã¾ã™"
      responses:
        "200":
          description: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼çµ±è¨ˆæƒ…å ±"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/PlayerStatsResponse"
        "404":
          description: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiErrorResponse"